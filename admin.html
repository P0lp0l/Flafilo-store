<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙÙ„Ø§ÙÙŠÙ„Ùˆ ğŸ”</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <style>
        body { background: #f0f2f5; padding-top: 50px; }
        .admin-card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        #admin-content { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div id="login-section" class="row justify-content-center">
        <div class="col-md-4 admin-card text-center">
            <h3>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† ğŸ˜</h3>
            <input type="email" id="email" class="form-control mb-2" placeholder="Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„">
            <input type="password" id="password" class="form-control mb-3" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button onclick="login()" class="btn btn-primary w-100">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div id="admin-content" class="row">
        <div class="col-md-4">
            <div class="admin-card">
                <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="p-name" class="form-control mb-2" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‡Ø¯ÙŠØ©">
                <input type="text" id="p-price" class="form-control mb-2" placeholder="Ø§Ù„Ø³Ø¹Ø±">
                <input type="text" id="p-image" class="form-control mb-2" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
                <button onclick="addProduct()" class="btn btn-success w-100">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ØªØ¬Ø±</button>
            </div>
        </div>
        <div class="col-md-8">
            <div class="admin-card">
                <h4>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
                <div id="list"></div>
            </div>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyDBfSCT_wePT2RexgcxZaz9NT9gWmXxgz0",
        authDomain: "flafilo-store.firebaseapp.com",
        projectId: "flafilo-store",
        storageBucket: "flafilo-store.firebasestorage.app",
        messagingSenderId: "470812703135",
        appId: "1:470812703135:web:ee2359353b3ad64b36a5aa",
        measurementId: "G-WH1VNZZ7VS"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    function login() {
        auth.signInWithEmailAndPassword(document.getElementById('email').value, document.getElementById('password').value)
        .catch(err => alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„: " + err.message));
    }

    auth.onAuthStateChanged(user => {
        if(user) {
            document.getElementById('login-section').style.display='none';
            document.getElementById('admin-content').style.display='flex';
            loadAdminProducts();
        }
    });

    function addProduct() {
        const name = document.getElementById('p-name').value;
        const price = document.getElementById('p-price').value;
        const image = document.getElementById('p-image').value;
        if(name && price && image) {
            db.collection("gifts").add({ name, price, image }).then(() => {
                alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­!");
                document.getElementById('p-name').value = "";
                document.getElementById('p-price').value = "";
                document.getElementById('p-image').value = "";
            });
        } else {
            alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        }
    }

    function loadAdminProducts() {
        db.collection("gifts").onSnapshot(snap => {
            const list = document.getElementById('list');
            list.innerHTML = "";
            snap.forEach(doc => {
                list.innerHTML += `<div class="p-2 border-bottom d-flex justify-content-between align-items-center">
                    <span>${doc.data().name} - ${doc.data().price} Ø¬.Ù…</span>
                    <button class="btn btn-danger btn-sm" onclick="deleteItem('${doc.id}')">Ø­Ø°Ù</button>
                </div>`;
            });
        });
    }

    function deleteItem(id) { 
        if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ")) {
            db.collection("gifts").doc(id).delete(); 
        }
    }
</script>
</body>
</html>
